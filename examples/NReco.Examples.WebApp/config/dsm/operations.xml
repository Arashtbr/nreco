<components	
	xmlns:r="urn:schemas-nreco:nreco:core:v1" 
	xmlns:d="urn:schemas-nreco:nicnet:dalc:v1"
	xmlns:e="urn:schemas-nreco:nreco:entity:v1"
	xmlns:xi="http://www.w3.org/2003/XInclude">

	<!-- this operation will be called from Global.asax each time when application starts -->
	<r:chain name="on-webapp-init">
		<r:execute target="initDbSchema"/>
	</r:chain>
	
	<!-- just executes SQL commands batch that verifies that all required tables are exist -->
	<r:chain name="initDbSchema">
		<r:execute>
			<r:target>
				<r:invoke method="Execute" target="db">
					<r:args>
						<r:const>
							<e:entity-create-sql>
								<xi:include href="entities.xml" xpointer="xpointer(/components/*)"/>
							</e:entity-create-sql>
						</r:const>
					</r:args>
				</r:invoke>
			</r:target>
		</r:execute>
	</r:chain>

	<e:dataset-factory name="dsFactory">
		<xi:include href="entities.xml" xpointer="xpointer(/components/*)"/>
	</e:dataset-factory>
	
	<!-- page-specific operations -->
	<!--r:chain name="pageSaveVisibility">
		<r:execute>
			<r:target>
				<r:each>
					<r:from></r:from>
				</r:each>
			</r:target>
		</r:execute>
		
	</r:chain-->

	<d:dalc-provider name="pageByTypeDataPrv" from="db" result="recordlist">
		<d:query>pages_by_type_view[*]</d:query>
	</d:dalc-provider>

	<d:dalc-provider name="pageByTagDataPrv" from="db" result="recordlist">
		<d:query>pages_by_tag_view[*]</d:query>
	</d:dalc-provider>
	

</components>